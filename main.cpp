#include <Windows.h>
#include <iostream>

#include "memory.hpp"
#include "ifexist.hpp"

using namespace std;

Injector inj;

DWORD pid;

//now it's global
LPVOID ntOpenFile = GetProcAddress(LoadLibraryW(L"ntdll"), "NtOpenFile");

void bypass()
{
	// Restore original NtOpenFile from external process
	//credits: Daniel Krupi√±ski(pozdro dla ciebie byczku <3)
	if (ntOpenFile) {
		char originalBytes[5];
		memcpy(originalBytes, ntOpenFile, 5);
		WriteProcessMemory(inj.process, ntOpenFile, originalBytes, 5, NULL);
	}
	else
	{
		cout << "IMPOSIBLE HACER ByPASS :(\n";
		Sleep(2000);
		exit(-1);
	}
}

void Backup()
{
	if (ntOpenFile) {
		//So, when I patching first 5 bytes I need to backup them to 0? (I think)
		char originalBytes[5];
		memcpy(originalBytes, ntOpenFile, 5);
		WriteProcessMemory(inj.process, ntOpenFile, originalBytes, 0, NULL);
	}
	else
	{
		cout << "No Puedo hacer BackUp :(\n";
		Sleep(2000);
		exit(-1);
	}
}

int main()
{
	system("CLS");
	SetConsoleTitle("MiK0 v.2 By SuperK2 | CS:GO Cheat Injector | 10/Oct/2021 | CheatersUnidos.com");
	cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@//////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@@@@@@@@@@@(//////////////////////////////////(@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@@@@@@//////////////////////////////////////////////@@@@@@@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@@@/////////////////////////////////////////////////////@@@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@/////////////////////////////////////////////////////////@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@///////////////////////////////////////////////////////////@@@@@@@@@@" << endl;
	cout << "    @@@@@@ % %@@////////////////////////////////////////////////////////////%@@@@@@@" << endl;
	cout << "    @@/////////////////////@@@@@@@@@@@@@@//@//////////////////////////////////////@@" << endl;
	cout << "    @////////////////////@@@@@@@@@@@@@@@@@@//@@@@//@@@@@@@@@@@@@@@@@////////////////" << endl;
	cout << "    ////////////////////@@@//////(@@@@@@@@@@/@@@@@@@@@@@@@@@@@@@@@@@@///////////////" << endl;
	cout << "    @//////////////////@@@@/////(///////////%@@@@@@@@@@@@@@///////#@%///////////////" << endl;
	cout << "    @///////////////////@@@//////@@@@/(@@///////////////@///(@////@@///////////////@" << endl;
	cout << "    @@//////////////////@@@@////////////////////@@@//////////////@@///////////////@@" << endl;
	cout << "    @@@@/////////////////&@@@@@//////////////@@@@@@@@@////////@@@@//////////////@@@@" << endl;
	cout << "    @@@@@///////////////////@@@@@@@@@@@@@@@@@@////@////@@@@@@@@@//////////////@@@@@@" << endl;
	cout << "    @@@@@@@@///////////////////#@@@@@@@@@@@@/////@@@////@@@@@(/////////////@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@//////////////////@@@@@@@@@@@@@@@@@@@@@@@@@@@////////////@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@@@@//////////////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@///////////@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@@@@@////////////#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/////////@@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@@@@@@@//////////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@//////(@@@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@@@@@@@@////////@@@@@@@@@@@@////////////////@@@@//////@@@@@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@@@@@@@@@@#/////@@@@@@////&@@@@@@@@@@@@@@@///////////@@@@@@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@@@@@@@@@@@@@/////////@@@@@@@@@@@@@@@@@@@@@@@@@////@@@@@@@@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@////@@@@@@@@@@@@@@@@@@@@@@@@@@@//@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ / @@@@@@@@@@@@@@@@@@@@@@@@@@ / @@@@@@@@@@@@@@@@@@" << endl;
	cout << "       MIK0 v.2 By SuperK2 | CS:GO Cheat Injector | www.CheatersUnidos.com    " << endl;
	cout << "     Special Thanks to the Original Creators: Daniel Krupinski, online-9, Hitchance" << endl;
	cout << "      NEED HELP ? www.CheatersUnidos.com  or Discord: https://discord.gg/4Sh8PJP" << endl;
	cout << "                             >>>>>>>> INJECTING, PLEASE WAIT ..." << endl;
	Sleep(4000);

	inj.hwndproc = FindWindowA(0, "Counter-Strike: Global Offensive");


	GetWindowThreadProcessId(inj.hwndproc, &pid);
	inj.process = OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid);

	inj.clientDLL = inj.GetModule(pid, "client.dll");

	if (DoesFileExist("cheat.dll")) {
		bypass();

		if (inj.inject(pid, "cheat.dll")) {
			
			
			system("CLS");
			system("Color 0A");
cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@//////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@@@@(//////////////////////////////////(@@@@@@@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@//////////////////////////////////////////////@@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@/////////////////////////////////////////////////////@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@/////////////////////////////////////////////////////////@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@///////////////////////////////////////////////////////////@@@@@@@@@@" << endl;
cout << "    @@@@@@ % %@@////////////////////////////////////////////////////////////%@@@@@@@" << endl;
cout << "    @@/////////////////////@@@@@@@@@@@@@@//@//////////////////////////////////////@@" << endl;
cout << "    @////////////////////@@@@@@@@@@@@@@@@@@//@@@@//@@@@@@@@@@@@@@@@@////////////////" << endl;
cout << "    ////////////////////@@@//////(@@@@@@@@@@/@@@@@@@@@@@@@@@@@@@@@@@@///////////////" << endl;
cout << "    @//////////////////@@@@/////(///////////%@@@@@@@@@@@@@@///////#@%///////////////" << endl;
cout << "    @///////////////////@@@//////@@@@/(@@///////////////@///(@////@@///////////////@" << endl;
cout << "    @@//////////////////@@@@////////////////////@@@//////////////@@///////////////@@" << endl;
cout << "    @@@@/////////////////&@@@@@//////////////@@@@@@@@@////////@@@@//////////////@@@@" << endl;
cout << "    @@@@@///////////////////@@@@@@@@@@@@@@@@@@////@////@@@@@@@@@//////////////@@@@@@" << endl;
cout << "    @@@@@@@@///////////////////#@@@@@@@@@@@@/////@@@////@@@@@(/////////////@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@//////////////////@@@@@@@@@@@@@@@@@@@@@@@@@@@////////////@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@//////////////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@///////////@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@////////////#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/////////@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@//////////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@//////(@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@////////@@@@@@@@@@@@////////////////@@@@//////@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@@@#/////@@@@@@////&@@@@@@@@@@@@@@@///////////@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@@@@@@/////////@@@@@@@@@@@@@@@@@@@@@@@@@////@@@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@////@@@@@@@@@@@@@@@@@@@@@@@@@@@//@@@@@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ / @@@@@@@@@@@@@@@@@@@@@@@@@@ / @@@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@   MIK0 v.2       !!!  .DLL INJECTED  !!!  .DLL INJECTED  !!!                \n" << endl;
cout << "     Special Thanks to the Original Creators: Daniel Krupinski, online-9, Hitchance" << endl;
cout << "      NEED HELP ? www.CheatersUnidos.com  or Discord: https://discord.gg/4Sh8PJP" << endl;
			
			Backup();
			Sleep(5000);
			exit(0);
		}
		else
		{

			system("CLS");
			system("Color 0C");
cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@//////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@@@@(//////////////////////////////////(@@@@@@@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@//////////////////////////////////////////////@@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@/////////////////////////////////////////////////////@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@/////////////////////////////////////////////////////////@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@///////////////////////////////////////////////////////////@@@@@@@@@@" << endl;
cout << "    @@@@@@ % %@@////////////////////////////////////////////////////////////%@@@@@@@" << endl;
cout << "    @@/////////////////////@@@@@@@@@@@@@@//@//////////////////////////////////////@@" << endl;
cout << "    @////////////////////@@@@@@@@@@@@@@@@@@//@@@@//@@@@@@@@@@@@@@@@@////////////////" << endl;
cout << "    ////////////////////@@@//////(@@@@@@@@@@/@@@@@@@@@@@@@@@@@@@@@@@@///////////////" << endl;
cout << "    @//////////////////@@@@/////(///////////%@@@@@@@@@@@@@@///////#@%///////////////" << endl;
cout << "    @///////////////////@@@//////@@@@/(@@///////////////@///(@////@@///////////////@" << endl;
cout << "    @@//////////////////@@@@////////////////////@@@//////////////@@///////////////@@" << endl;
cout << "    @@@@/////////////////&@@@@@//////////////@@@@@@@@@////////@@@@//////////////@@@@" << endl;
cout << "    @@@@@///////////////////@@@@@@@@@@@@@@@@@@////@////@@@@@@@@@//////////////@@@@@@" << endl;
cout << "    @@@@@@@@///////////////////#@@@@@@@@@@@@/////@@@////@@@@@(/////////////@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@//////////////////@@@@@@@@@@@@@@@@@@@@@@@@@@@////////////@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@//////////////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@///////////@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@////////////#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/////////@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@//////////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@//////(@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@////////@@@@@@@@@@@@////////////////@@@@//////@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@@@#/////@@@@@@////&@@@@@@@@@@@@@@@///////////@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@@@@@@/////////@@@@@@@@@@@@@@@@@@@@@@@@@////@@@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@////@@@@@@@@@@@@@@@@@@@@@@@@@@@//@@@@@@@@@@@@@@@@@@@@" << endl;
cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ / @@@@@@@@@@@@@@@@@@@@@@@@@@ / @@@@@@@@@@@@@@@@@@" << endl;
cout << "    ********************************************************************************" << endl;
cout << "    ****  ### ERROR ### ERROR ###      INJECTION FAIL ... IS CS:GO RUNING??      ***" << endl;
cout << "    ********************************************************************************" << endl;
cout << "    Special Thanks to the Original Creators: Daniel Krupinski, online-9, Hitchance" << endl;
cout << "    NEED HELP ? https://www.CheatersUnidos.com  or Discord: https://discord.gg/4Sh8PJP" << endl;
			
			Backup();
			Sleep(10000);
			exit(-1);
		}
	
	}
	else
	{
		system("CLS");
		system("Color 0C");
		cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@//////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@@@@@@@@@@@(//////////////////////////////////(@@@@@@@@@@@@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@@@@@@//////////////////////////////////////////////@@@@@@@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@@@/////////////////////////////////////////////////////@@@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@/////////////////////////////////////////////////////////@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@///////////////////////////////////////////////////////////@@@@@@@@@@" << endl;
		cout << "    @@@@@@ % %@@////////////////////////////////////////////////////////////%@@@@@@@" << endl;
		cout << "    @@/////////////////////@@@@@@@@@@@@@@//@//////////////////////////////////////@@" << endl;
		cout << "    @////////////////////@@@@@@@@@@@@@@@@@@//@@@@//@@@@@@@@@@@@@@@@@////////////////" << endl;
		cout << "    ////////////////////@@@//////(@@@@@@@@@@/@@@@@@@@@@@@@@@@@@@@@@@@///////////////" << endl;
		cout << "    @//////////////////@@@@/////(///////////%@@@@@@@@@@@@@@///////#@%///////////////" << endl;
		cout << "    @///////////////////@@@//////@@@@/(@@///////////////@///(@////@@///////////////@" << endl;
		cout << "    @@//////////////////@@@@////////////////////@@@//////////////@@///////////////@@" << endl;
		cout << "    @@@@/////////////////&@@@@@//////////////@@@@@@@@@////////@@@@//////////////@@@@" << endl;
		cout << "    @@@@@///////////////////@@@@@@@@@@@@@@@@@@////@////@@@@@@@@@//////////////@@@@@@" << endl;
		cout << "    @@@@@@@@///////////////////#@@@@@@@@@@@@/////@@@////@@@@@(/////////////@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@//////////////////@@@@@@@@@@@@@@@@@@@@@@@@@@@////////////@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@@@@//////////////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@///////////@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@@@@@////////////#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/////////@@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@@@@@@@//////////@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@//////(@@@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@@@@@@@@////////@@@@@@@@@@@@////////////////@@@@//////@@@@@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@@@@@@@@@@#/////@@@@@@////&@@@@@@@@@@@@@@@///////////@@@@@@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@@@@@@@@@@@@@/////////@@@@@@@@@@@@@@@@@@@@@@@@@////@@@@@@@@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@////@@@@@@@@@@@@@@@@@@@@@@@@@@@//@@@@@@@@@@@@@@@@@@@@" << endl;
		cout << "    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ / @@@@@@@@@@@@@@@@@@@@@@@@@@ / @@@@@@@@@@@@@@@@@@\n" << endl;
		cout << "    * ERROR:FILE cheat.dll NOT DETECTED, REMEMBER TO RENAME YOUR .DLL AS cheat.dll *" << endl;
		cout << "    Special Thanks to the Original Creators: Daniel Krupinski, online-9, Hitchance" << endl;
		cout << "    NEED HELP ? https://www.CheatersUnidos.com  or Discord: https://discord.gg/4Sh8PJP" << endl;
		Sleep(10000);
		exit(-1);
	}

	return 0;
}
